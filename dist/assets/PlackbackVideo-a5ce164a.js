import{r as s,j as e}from"./react-472d7f6d.js";import{J as N}from"./jszip-1dcffc73.js";import{B as m,k as v}from"./@mui-74370819.js";import"./hoist-non-react-statics-d052b204.js";import"./clsx-5a9f8d06.js";import"./react-transition-group-ffe54232.js";import"./@babel-591e0485.js";import"./react-dom-4df14f11.js";import"./scheduler-765c72db.js";import"./@emotion-94b9ecb4.js";import"./stylis-79144faa.js";const J=()=>{const[r,g]=s.useState([]),[a,b]=s.useState(""),[l,y]=s.useState(""),[c,u]=s.useState(null),[p,E]=s.useState(null),[x,V]=s.useState(null),j=s.useRef(null),k=s.useRef(null),w="https://cors-anywhere.herokuapp.com/",C=async()=>{const t=a.split("T")[0],n=a.split("T")[1],o=l.split("T")[0],i=l.split("T")[1],d=`http://127.0.0.1:5000/videos?start_date=${t}&start_time=${n}&end_date=${o}&end_time=${i}`;try{const h=await(await fetch(d)).json();g(h.s3_videos||[]),h.s3_videos.length>0&&u(h.s3_videos[0])}catch(f){console.error("Error fetching videos:",f)}},S=async()=>{const t=new N;for(const n of r)try{const i=await(await fetch(w+n)).blob(),d=n.split("/").pop();t.file(d,i)}catch(o){console.error("Error downloading video:",o)}t.generateAsync({type:"blob"}).then(n=>{const o=document.createElement("a");o.href=URL.createObjectURL(n),o.download="videos.zip",document.body.appendChild(o),o.click(),document.body.removeChild(o)})},T=()=>{const t=r.indexOf(c);t!==-1&&t<r.length-1&&u(r[t+1])},D=()=>{if(x){const t=document.createElement("a");t.href=x,t.download="screenshot.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}};return e.jsxs("div",{className:"flex min-h-screen bg-white",children:[e.jsxs("div",{className:"w-[70%] flex flex-col items-center pt-10 text-gray-500 text-lg bg-gray-200",children:[e.jsx("h1",{className:"mb-4 text-xl font-semibold",children:"Playback Video Player"}),e.jsx("div",{children:c?e.jsx("video",{ref:j,width:"1020",height:"720",controls:!0,autoPlay:!0,muted:!0,src:c,onEnded:T}):e.jsx("p",{className:"text-gray-500",children:"Click on a video to play it."})}),p&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Captured Screenshot"}),e.jsx("img",{src:p,alt:"Screenshot",className:"mt-2 border rounded"}),e.jsx("div",{className:"mt-2",children:e.jsx(m,{variant:"contained",onClick:D,sx:{backgroundColor:"#1976d2",color:"white",height:"48px","&:hover":{backgroundColor:"#1565c0"}},children:"Download Screenshot"})})]}),e.jsx("canvas",{ref:k,style:{display:"none"}})," "]}),e.jsxs("div",{className:"w-[30%] p-8 space-y-6 bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Start Date Time:"}),e.jsx(v,{type:"datetime-local",value:a,onChange:t=>b(t.target.value),fullWidth:!0,variant:"outlined",sx:{backgroundColor:"#f0f0f0"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"End Date Time:"}),e.jsx(v,{type:"datetime-local",value:l,onChange:t=>y(t.target.value),fullWidth:!0,variant:"outlined",sx:{backgroundColor:"#f0f0f0"}})]}),e.jsx(m,{variant:"contained",fullWidth:!0,onClick:C,sx:{backgroundColor:"#1976d2",color:"white",height:"48px","&:hover":{backgroundColor:"#1565c0"}},children:"SHOW VIDEO"}),e.jsx(m,{variant:"contained",fullWidth:!0,onClick:S,sx:{backgroundColor:"#1976d2",color:"white",height:"48px","&:hover":{backgroundColor:"#1565c0"}},children:"Download Videos"})]})]})};export{J as default};
